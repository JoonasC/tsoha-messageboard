{% extends "layout/layout.html" %}
{% from "macro/render_if_user_has_sufficient_credentials.html" import render_if_user_has_sufficient_credentials with context %}
{% block title %}message_chain.name{% endblock %}
{% block page_content %}
<div class="h-100 pt-4 bg-whitesmoke">
    <div class="container d-flex flex-column h-100 pb-1 border border-bottom-0 bg-white">
        <div class="py-1 mb-1 border-bottom">
            <h1 class="mb-0 fw-light">{{ message_chain.name }}</h1>
        </div>
        <div class="d-flex justify-content-end mb-2">
            <a href="#" class="btn btn-success">Reply to message chain</a>
        </div>
        {% if messages.values()|length > 0 %}
        <div class="px-2">
            {% for message in messages.values() %}
            <div class="border p-1 mb-1">
                <p class="fw-bold">{{ users[message.user_entity_id].username }}</p>
                <p>{{ message.content }}</p>
                <div class="d-flex text-muted text-decoration-none">
                    {% call render_if_user_has_sufficient_credentials(message.user_entity_id, false) %}
                    <a href="#"><i class="bi bi-pencil"></i> Edit</a>
                    {% endcall %}
                    {% call render_if_user_has_sufficient_credentials(message.user_entity_id) %}
                    <a href="#"><i class="bi bi-trash"></i> Delete</a>
                    {% endcall %}
                    <a href="#"><i class="bi bi-reply"></i> Reply</a>
                </div>
            </div>
            {% endfor %}
        </div>
        <div class="d-flex justify-content-end mt-1">
            <a href="#" class="btn btn-success">Reply to message chain</a>
        </div>
        {% else %}
        <div class="flex-fill d-flex justify-content-center align-items-center text-muted">
            <h3 class="fw-light">
                <i class="bi bi-exclamation-circle"></i> It seems like there are no messages available
            </h3>
        </div>
        {% endif %}
    </div>
</div>
{% endblock %}
